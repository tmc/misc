# Test YAML frontmatter handling

# Start server normally (frontmatter should be stripped)
exec md2html -input frontmatter.md -http :8095 &
sleep 1s

# Test that frontmatter is not visible in output by default
exec curl -s http://localhost:8095/
! stdout 'title: Test Document'

# Test content after frontmatter is rendered
exec curl -s http://localhost:8095/
stdout 'Content After Frontmatter'

exec pkill -f 'md2html.*8095'

# Now test with -render-frontmatter flag
exec md2html -input frontmatter.md -render-frontmatter -http :8096 &
sleep 1s

# Test that frontmatter IS visible with flag (rendered as YAML code block)
exec curl -s http://localhost:8096/
stdout 'Test Author'

# Cleanup
exec pkill -f 'md2html.*8096'

-- frontmatter.md --
---
title: Test Document
author: Test Author
date: 2024-01-01
---

# Content After Frontmatter

This is the actual content.