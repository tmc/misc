#!/bin/bash

# Function to parse and display goals in both old and new formats
parse_and_display_goals() {
    while IFS= read -r line; do
        if [[ $line == \#* ]]; then
            # New format: #ID | Status | Description
            IFS='|' read -r id status description <<< "${line#\#}"
            printf "%-5s %-10s %s\n" "${id## }" "${status## }" "${description## }"
        else
            # Old format: just print the line as-is
            echo "$line"
        fi
    done < "$1"
}

# Check if .git-goals file exists
if [ ! -f .git-goals ]; then
    echo "No goals found. Use 'git goals create' to add a new goal."
    exit 0
fi

# Display header
echo "ID    Status      Description"
echo "---   ------      -----------"

# Parse and display goals
parse_and_display_goals .git-goals
