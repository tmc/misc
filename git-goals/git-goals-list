#!/bin/bash
# git-goals-list - Lists all goals
set -euo pipefail

echo "Current Goals:"
git notes --ref=goals list | while read -r commit_hash note_ref; do
    goal_data=$(git notes --ref=goals show "$commit_hash")
    goal_id=$(echo "$goal_data" | grep -o '"id": *"[^"]*"' | cut -d'"' -f4)
    status=$(echo "$goal_data" | grep -o '"status": *"[^"]*"' | cut -d'"' -f4)
    description=$(echo "$goal_data" | grep -o '"description": *"[^"]*"' | cut -d'"' -f4)
    if [ -n "$goal_id" ] && [ -n "$status" ] && [ -n "$description" ]; then
        echo "- $goal_id ($status): $description"
    fi
done || echo "No goals found."