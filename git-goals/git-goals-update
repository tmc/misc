#!/bin/bash

# Check if ID and new status are provided
if [ $# -lt 2 ]; then
    echo "Error: Please provide a goal ID and the new status."
    echo "Usage: git goals update <id> <new_status>"
    exit 1
fi

id="$1"
new_status="$2"

# Check if .git-goals file exists
if [ ! -f .git-goals ]; then
    echo "Error: No goals found. Use 'git goals create' to add a new goal."
    exit 1
fi

# Update the goal status
sed -i "s/^#$id |[^|]*|/#$id | $new_status |/" .git-goals

# Check if the update was successful
if grep -q "^#$id | $new_status |" .git-goals; then
    echo "Goal $id updated successfully. New status: $new_status"
else
    echo "Error: Failed to update goal $id. Make sure the ID exists."
    exit 1
fi
