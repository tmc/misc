#!/usr/bin/bash
# Input validation and error handling
# Load configuration
if [ -f ".git-goals-config" ]; then
if [ -f ".git-goals-config" ]; then
    source ".git-goals-config"
else
    echo "Warning: .git-goals-config not found. Using default settings."
fi
    source ".git-goals-config"
fi

NOTE_REF_NAME=${NOTE_REF_NAME:-goals}
DATE_FORMAT=${DATE_FORMAT:-%Y-%m-%d}
MAX_GOALS_DISPLAY=${MAX_GOALS_DISPLAY:-0}

if [ "$1" = "--help" ]; then
    echo "Usage: git goals create [options]"
    echo "Options:"
    echo "  --help    Show this help message"
    exit 0
fi
if [ $# -eq 0 ]; then
    echo -e "\033[1mUsage: $0 <args>"
    exit 1
fi

set -euo pipefail

if [ "$1" = "--help" ]; then
    echo "Usage: git goals create [options]"
    echo "Options:"
    echo "  --help    Show this help message"
    exit 0
fi
if [ $# -eq 0 ]; then
    echo -e "\033[1mError: Please provide a description for the goal."
    echo -e "\033[1mUsage: git goals create <description>"
    exit 1
fi

description="$*"
id=$(date +%Y%m%d%H%M%S)

git notes --ref=goals add -m "id: $id
type: goal
description: $description
status: active
created_at: $(date -I)" HEAD

echo -e "\033[1mCreated new goal with ID: $id"
echo -e "\033[1mDescription: $description"
